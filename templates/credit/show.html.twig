{% extends 'layout/dashboard.html.twig' %}

{% block title %}Gutschrift #{{ credit.id }}{% endblock %}

{% block main %}
<div class="container mx-auto p-6 space-y-6 dark:text-gray-100">
    <div class="flex items-center justify-between">
        <h1 class="text-2xl font-semibold">Gutschrift #{{ credit.id }}</h1>
        <div class="space-x-2">
            <a href="{{ path('app_credit_edit', {id: credit.id}) }}" class="px-3 py-1 rounded bg-yellow-600 text-white">Bearbeiten</a>
            <a href="{{ path('app_credit_index') }}" class="px-3 py-1 rounded bg-gray-600 text-white">Zur Liste</a>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
            <div class="text-sm text-gray-400 dark:text-gray-300">Beleg-ID</div>
            <div class="text-lg">{{ credit.documentId }}</div>
        </div>
        <div>
            <div class="text-sm text-gray-400 dark:text-gray-300">Erstellt am</div>
            <div class="text-lg">{{ credit.createdAt ? credit.createdAt|date('Y-m-d H:i') : '' }}</div>
        </div>
        <div>
            <div class="text-sm text-gray-400 dark:text-gray-300">Person</div>
            <div class="text-lg">{{ credit.person ? credit.person.name : '-' }}</div>
        </div>
        <div>
            <div class="text-sm text-gray-400 dark:text-gray-300">Abrechnungsperiode</div>
            <div class="text-lg">{{ credit.billingPeriode ? credit.billingPeriode|date('Y-m-d') : '-' }}</div>
        </div>
    </div>

    <div>
        <h2 class="text-xl font-semibold mb-2">Positionen</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full text-left">
                <thead>
                    <tr class="border-b">
                        <th class="py-2 px-3">Pos</th>
                        <th class="py-2 px-3">Bezeichnung</th>
                        <th class="py-2 px-3">Beschreibung</th>
                        <th class="py-2 px-3">Menge</th>
                        <th class="py-2 px-3">Einheit</th>
                        <th class="py-2 px-3">EP netto</th>
                        <th class="py-2 px-3">MwSt %</th>
                        <th class="py-2 px-3">Summe netto</th>
                        <th class="py-2 px-3">Summe brutto</th>
                    </tr>
                </thead>
                <tbody>
                {% for item in credit.creditItems %}
                    <tr class="border-b">
                        <td class="py-2 px-3">{{ item.position }}</td>
                        <td class="py-2 px-3">{{ item.name }}</td>
                        <td class="py-2 px-3 whitespace-pre-line">{{ item.description }}</td>
                        <td class="py-2 px-3">{{ item.quantity }}</td>
                        <td class="py-2 px-3">{{ item.unit }}</td>
                        <td class="py-2 px-3">{{ item.unitNetPrice }}</td>
                        <td class="py-2 px-3">{{ item.taxRate }}</td>
                        <td class="py-2 px-3">{{ item.totalNet }}</td>
                        <td class="py-2 px-3">{{ item.totalGross }}</td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="9" class="py-4 px-3 text-center text-gray-400 dark:text-gray-300">Keine Positionen vorhanden.</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div class="text-right">
        <form method="post" action="{{ path('app_credit_delete', {id: credit.id}) }}" onsubmit="return confirm('Wirklich löschen?');">
            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ credit.id) }}">
            <button class="px-3 py-1 rounded bg-red-600 text-white" type="submit">Löschen</button>
        </form>
    </div>
</div>
{% endblock %}
